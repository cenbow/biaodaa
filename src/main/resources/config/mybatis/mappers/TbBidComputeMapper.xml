<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.silita.biaodaa.dao.TbBidComputeMapper" >
  <resultMap id="BaseResultMap" type="com.silita.biaodaa.model.TbBidCompute" >
    <!--
      WARNING - @mbg.generated
    -->
    <id column="pkid" property="pkid" jdbcType="INTEGER" />
    <result column="user_id" property="userId" jdbcType="VARCHAR" />
    <result column="pro_name" property="proName" jdbcType="VARCHAR" />
    <result column="sec_name" property="secName" jdbcType="VARCHAR" />
    <result column="pro_type" property="proType" jdbcType="VARCHAR" />
    <result column="bid_way" property="bidWay" jdbcType="VARCHAR" />
    <result column="bid_date" property="bidDate" jdbcType="VARCHAR" />
    <result column="status" property="status" jdbcType="INTEGER" />
    <result column="created" property="created" jdbcType="TIMESTAMP" />
    <result column="cred_tmp" property="credTmp" jdbcType="LONGVARCHAR" />
  </resultMap>

  <insert id="insertBidCompute" parameterType="com.silita.biaodaa.model.TbBidCompute" keyProperty="pkid" useGeneratedKeys="true">
        insert into `tb_bid_compute`(`user_id`,`pro_name`,`sec_name`,`pro_type`,`bid_way`,`bid_date`,`cred_tmp`)
        values (#{userId},#{proName},#{secName},#{proType},#{bidWay},#{bidDate},#{credTmp})
  </insert>

  <select id="queryBidComputeList" parameterType="java.util.Map" resultMap="BaseResultMap">
    select t.pro_name,t.sec_name,pro_type,bid_way,bid_date,t.pkid
    from tb_bid_compute t
    where t.status = 1 and t.user_id = #{userId}
    order by t.created desc
  </select>

  <update id="delBidComput" parameterType="java.util.Map">
      update tb_bid_compute t set t.status = 0 where t.pkid = #{pkid}
  </update>

  <select id="queryProType" parameterType="java.lang.Integer" resultType="String">
    select
      case when pro_type = '房建' then '建筑工程'
      when pro_type = '市政' then '市政公用工程'
      else pro_type
      end as proType
    from
      tb_bid_compute
    where pkid = #{pkid} and `status`=1
  </select>
</mapper>